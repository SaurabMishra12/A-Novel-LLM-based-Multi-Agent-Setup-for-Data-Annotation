ContextClassifier = Agent(
    role="Legal Context Analyzer",
    goal="Perform detailed analysis of court case documents to extract precise contextual information",
    backstory="""You are a meticulous legal document reviewer with exceptional attention to detail.
    Your expertise lies in dissecting complex legal documents, extracting nuanced contextual information,
    and providing comprehensive analysis that captures the essence of legal statements.""",
    verbose=True,
    allow_delegation=False,
    memory=True,
    llm=my_llm1,
    cache=True
)

# Task for Context Classifier
ContextClassifierTask = Task(
    description="""

    Here is the INPUT sentence that you need to annotate: {sentence}

You Will be provided sentences line by line from the court case: {case}

________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
    Comprehensive Context Analysis Task:

    OBJECTIVES:
    0. Analyze the data given to you.
    1. Thoroughly analyze the entire case document to extract contextual information about the {sentence}
    2. Extract precise contextual matching for the given legal statement
    3. Identify:
       - Supporting evidence
       - Contradictory arguments
       - Relevant legal precedents
       - Surrounding contextual details

    ANALYSIS REQUIREMENTS:
    - Provide a structured, detailed breakdown of the statement's context
    - Highlight key legal elements and their significance
    - Prepare a comprehensive summary for further classification

    OUTPUT FORMAT:
    - Detailed contextual analysis
    - Check the sentence context from the overall case.
    - Evidence mapping
    - Potential classification indicators


     VALIDATION CHECKLIST:
    □ Check the CLASSIFICATION PROCESS
    □ Checked for ambiguity
    □ Confirmed that the output is passed to Legal Label Standardizer Agent(Important)


    """,
    agent=ContextClassifier,
    verbose=True,
    expected_output="share Comprehensive contextual analysis document with Legal Classification Decisioner Agent",
    shared_memory=True
)




RoleDefinitionValidator = Agent(
    role="Legal Classification Validator",
    goal="Validate and contextualize legal statement classifications and give predefined role by analysing definitions, examples, and counterexamples.",
    backstory="""As a seasoned legal expert, you possess an intricate understanding of legal
    classification systems. Your role is to meticulously validate statements against
    predefined legal categories, providing authoritative examples and counterexamples
    to ensure precise categorization.""",
    verbose=True,
    allow_delegation=False,
    memory=True,
    llm= my_llm2,
    cache=True
)

# Task for Role Definition Validator
RoleDefinitionValidatorTask = Task(
    description="""
    Legal Classification Validation Task:

    VALIDATION PROCESS:
    0. Analyze the context of the given sentence before proceeding.
    1. Review and analyze contextual analysis from Context Classifier
    2. Analyze all the information given to you.
    3. Apply predefined legal classification categories:
       - Facts
       - Ratio of the Decision
       - Ruling by Lower Court
       - Precedent
       - Argument
       - Ruling by Present Court
       - Statute

________________________________________________________________________________________________________________________________________________________________
 1. Facts (FAC)
    - Defination:Facts (abbreviated as FAC): This refers to the chronology of events that led to filing the case, and how the case evolved over time in the legal system (e.g., First Information Report at a police station, filing an appeal to the Magistrate, etc.)\n"
    Primary Indicators:
    - Contains specific dates, names, locations, or monetary values
    - Describes chronological events without legal interpretation
    - Uses past tense verbs
    - Contains objective, verifiable information
    Common Phrases:
    - "On [date]..."
    - "[Person] filed/submitted/executed..."
    - "The property was located at..."
    Examples:
    - "It was averred in the plaint that Ramalakshmi obtained a vested interest in the suit -properties under the will of her father and plaintiff was thus entitled to maintain the suit" : Facts
    - "On the 18th September, 1945, the suit out of which this appeal arises was instituted by the plaintiff, the husband and the sole heir of Ramalakshmi, for a declaration that the said sale would not be binding on him beyond the lifetime of the widow" : Facts
    - After your lifetime Ramalakshmi Ammal, our daughter and wife of Rama Ayyar Avergal of Melagaram village, and her heirs shall enjoy them with absolute rights and powers of alienation such as gift, exchange, and sale from son to grandson and so on for generations: Facts
    - The High Court by its judgment under appeal affirmed the decision of the trial judge and maintained his view on the construction of the will:  Facts
    Counter-Examples:
    - "The court considered the validity of the transfer" (Argument)
    - "According to Section 14..." (Statute)
    - "The widow cannot be held to have been given a full Hindu widow's estate under the will unless it can be said that under its terms she was given the power of alienation for necessary purposes, whether in express terms or by necessary implication",(Ratio of the decision)


    2. Ratio of the decision (Ratio)
    Primary Indicators:
    - Explains legal reasoning process
    - Links facts to legal principles
    - Contains causal relationships
    - Explains "why" of the decision
    Common Phrases:
    - "In view of..."
    - "Considering that..."
    - "Based on the interpretation..."
    Examples:
    - "Given that the will did not explicitly grant absolute ownership rights, the widow's interest must be construed as limited to a life estate."
    - "The absence of express words conferring absolute ownership leads to the conclusion that only a limited estate was intended."
    - "There is no such indication in the will before us"
    - "But there were other indications in that will showing that a widow's estate had been given"
    3. Ruling by Lower Court (RLC)
    Primary Indicators:
    - References previous court proceedings
    - Mentions trial court or high court decisions
    - Describes earlier judicial findings
    Common Phrases:
    - "The trial court held..."
    - "The High Court found..."
    - "The lower court's judgment stated..."
    Examples:
    - "The Trial Court dismissed the petition holding that the widow had absolute rights."
    - "The High Court reversed the trial court's decision and declared the transfer void."
    - "In view of this finding he granted the plaintiff a declaratory decree to the effect that the first defendant had only an estate for life in the suit properties and that the alienations made by her would not endure beyond her lifetime"
    - ""
    4. Precedent (PRE)
    Primary Indicators:
    - Citations of previous cases
    - References to established legal principles
    - Mentions judicial history
    Common Phrases:
    - "Following the principle laid down in..."
    - "As held in..."
    - "Relying on..."
    Examples:
    - "Following the principle established in Mst. Karmi vs. Amru (1971)..."
    - "The court relied on the precedent set in Janki Ammal vs. Narayanswami."
    - "express restriction against alienation, the estate taken by S. (the niece) was an estate such as a woman ordinarily acquires by inheritance under the Hindu law which she holds in a completely representative character but is unable to alienate except in case of legal necessity and that such a construction was in accordance with the ordinary notions that a Hindu has in regard to devolution of his property"
    - "It was remarked that in spite of an"
    5. Argument (ARG)
    Primary Indicators:
    - Contains legal analysis
    - Weighs different interpretations
    - Discusses competing claims
    Common Phrases:
    - "It is contended that..."
    - "The petitioner argues..."
    - "On behalf of the respondent..."
    Examples:
    - "The petitioner contends that the will created only a limited estate."
    - "Counsel for the respondent argued that the transfer was valid under Hindu law."
    - "The learned counsel in support of his contention drew our attention to a number of decisions of different High Courts and contended that the words of this will should be construed in the manner as more or less similar words were construed by the courts in the wills dealt with in those decisions"
    6. Ruling by Present Court (RPC)
    Primary Indicators:
    - States final decision
    - Contains conclusive declarations
    - Provides specific orders
    Common Phrases:
    - "We hereby..."
    - "It is held that..."
    - "The court orders..."
    Examples:
    - "We hereby declare the transfer void and set aside the lower court's order."
    - "The appeal is allowed with costs."
    - "In our judgment, there is force in the contention of Mr. Rajah Iyer for reasons already stated and in the result, therefore, we dismiss this appeal with costs"
    - "After considering the rival contentions of the parties, we are of the opinion that no sufficient grounds have been made out for disturbing the unanimous opinion of the two courts below on the construction of this will

    7. Statute (STA)
    Primary Indicators:
    - References to specific laws
    - Mentions sections, articles, or rules
    - Quotes legal provisions
    Common Phrases:
    - "Under Section..."
    - "According to the Act..."
    - "As per Article..."
    Examples:
    - "As per Section 14 of the Hindu Succession Act..."
    - "Under Article 226 of the Constitution..."
________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________


    VALIDATION CRITERIA:
    - Provide precise definition for each potential classification
    - Generate concrete example for each category
    - Develop a contrasting counterexample
    - Compare with examples
    - Verify against counter-examples
    - Cross-reference statement against category definitions
    - Assess alignment and potential misclassifications

    OUTPUT REQUIREMENTS:
    □ Detailed validation report
    □ Confidence assessment(in percentage) for each potential classification
    □ Comparative analysis of classification candidates
    □ Checked for ambiguity
    □ Confirmed that the output is passed to Legal Classification Decisioner Agent(Important)

    """,
    agent=RoleDefinitionValidator,
    verbose=True,
    expected_output="Share Comprehensive classification validation report with Legal Classification Decisioner Agent",
    shared_memory=True
)









# Agent 3: Final Decision Arbitrator
FinalDecisionArbitrator = Agent(
    role="Legal Classification Decisioner",
    goal="Integrate contextual details and role definitions to provide a strict one-word classification with high precision",
    backstory="""You are the ultimate arbiter of legal classifications, synthesizing
    complex analytical inputs into a crisp, unambiguous categorization. Your judgment
    represents the culmination of rigorous contextual and definitional analysis.""",
    verbose=True,
    allow_delegation=False,
    memory=True,
    llm=my_llm3,
    cache=True
)

# Task for Final Decision Arbitrator
FinalDecisionArbitratorTask = Task(
    description="""
    Final Legal Classification Determination Task:

    DECISIONING PROCESS:
    1. analyze and Integrate contextual analysis from Context Classifier
    2. Incorporate validation insights from Role Definition Validator
    3. Calculate confidence score based on indicators present
    4. Apply strict classification rules
    5. Produce a definitive classification
    6. Apply tie-breaking rules if needed
    7. Output standardized label only if confidence threshold met

    CLASSIFICATION RULES:
    -CONFIDENCE SCORING:
    - output from Legal Context Analyzer agent: +1 points each
    - output from Legal Classification Validator agent: +2 points each
    - STRICT OUTPUT FORMAT: +2
    - VALIDATION CHECKLIST:+2

    Minimum confidence threshold: 7 points
      * Weighted evidence analysis
      * Comparative category assessment
      * Hierarchical decision logic


STRICT OUTPUT FORMAT:
    One of exactly these phrases:
    - Facts
    - Ratio of the decision
    - Ruling by Lower Court
    - Precedent
    - Argument
    - Ruling by Present Court
    - Statute

    STRICT OUTPUT REQUIREMENTS:
    - Single-word classification
    - No additional text or explanation
    - Must match predefined category exactly

    ESCALATION PROTOCOL:
    - If confidence < 7: check the logic of context and Combine outputs from Agent 1 (context analysis) and Agent 2 (role definitions).
    - Provide transparent decision-making rationale
    """,
    agent=FinalDecisionArbitrator,
    verbose=True,
    expected_output="Single-word legal classification: Facts, Ratio of the decision, Ruling by Lower Court, Precedent, Argument, Ruling by Present Court, Statute nothing else",
    shared_memory=True
)
